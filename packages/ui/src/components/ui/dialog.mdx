import { Canvas, Meta, Controls, Stories, Title, Description } from '@storybook/addon-docs/blocks';
import * as DialogStories from './dialog.stories';

<Meta of={DialogStories} />

<Title />

<Description>
  A modal dialog that overlays the main content and requires user interaction.
  Perfect for forms, confirmations, and focused tasks without navigation.
</Description>

## Overview

The Dialog component creates a modal overlay that captures focus and requires user interaction.
Unlike AlertDialog, it's designed for non-critical interactions like forms, settings, and content viewing.

### Key Features

- **Accessibility First**: Full ARIA support with focus management and keyboard navigation
- **Composable Structure**: Multiple sub-components for flexible layouts
- **Close Button**: Optional close button in top-right corner
- **Escape to Close**: Dismiss with Escape key
- **Backdrop Click**: Optional close on overlay click
- **Responsive Design**: Adapts to mobile and desktop viewports
- **Animation Support**: Smooth entrance and exit animations

## Usage

```tsx
import {
  Dialog,
  DialogContent,
  DialogDescription,
  DialogHeader,
  DialogTitle,
  DialogTrigger,
} from '@repo/ui/components/dialog'

export function DialogDemo() {
  return (
    <Dialog>
      <DialogTrigger asChild>
        <Button variant="outline">Edit Profile</Button>
      </DialogTrigger>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Edit profile</DialogTitle>
          <DialogDescription>
            Make changes to your profile here. Click save when you're done.
          </DialogDescription>
        </DialogHeader>
        <div className="grid gap-4 py-4">
          <div className="grid grid-cols-4 items-center gap-4">
            <Label htmlFor="name" className="text-right">
              Name
            </Label>
            <Input id="name" defaultValue="Pedro Duarte" className="col-span-3" />
          </div>
        </div>
      </DialogContent>
    </Dialog>
  )
}
```

## Interactive Example

<Canvas of={DialogStories.Default} />

<Controls of={DialogStories.Default} />

## When to Use Dialog vs AlertDialog

**Use Dialog for:**
- Forms and data entry
- Settings and preferences
- Content viewing (images, videos)
- Multi-step workflows
- Non-critical information

**Use AlertDialog for:**
- Destructive actions
- Critical decisions
- Warnings that require acknowledgment
- Confirmations that can't be easily undone

## Common Patterns

### Form Dialog

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Add User</Button>
  </DialogTrigger>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Add new user</DialogTitle>
      <DialogDescription>
        Fill in the user details below to create a new account.
      </DialogDescription>
    </DialogHeader>
    <form className="space-y-4">
      <div className="grid gap-2">
        <Label htmlFor="name">Name</Label>
        <Input id="name" placeholder="John Doe" />
      </div>
      <div className="grid gap-2">
        <Label htmlFor="email">Email</Label>
        <Input id="email" type="email" placeholder="john@example.com" />
      </div>
      <DialogFooter>
        <Button type="submit">Create user</Button>
      </DialogFooter>
    </form>
  </DialogContent>
</Dialog>
```

### Controlled Dialog

```tsx
import { useState } from 'react'

function ControlledDialog() {
  const [open, setOpen] = useState(false)

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        <Button>Open</Button>
      </DialogTrigger>
      <DialogContent>
        <DialogHeader>
          <DialogTitle>Controlled Dialog</DialogTitle>
        </DialogHeader>
        <p>This dialog's state is controlled externally.</p>
        <Button onClick={() => setOpen(false)}>Close</Button>
      </DialogContent>
    </Dialog>
  )
}
```

### Without Close Button

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Open</Button>
  </DialogTrigger>
  <DialogContent showCloseButton={false}>
    <DialogHeader>
      <DialogTitle>No close button</DialogTitle>
      <DialogDescription>
        Use the actions below or press Escape to close.
      </DialogDescription>
    </DialogHeader>
    <DialogFooter>
      <DialogClose asChild>
        <Button variant="outline">Cancel</Button>
      </DialogClose>
      <Button>Confirm</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

### Scrollable Content

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>View Terms</Button>
  </DialogTrigger>
  <DialogContent className="max-h-[80vh]">
    <DialogHeader>
      <DialogTitle>Terms of Service</DialogTitle>
    </DialogHeader>
    <div className="overflow-y-auto pr-4">
      <p className="text-sm text-muted-foreground">
        {/* Long content here */}
      </p>
    </div>
    <DialogFooter>
      <Button>Accept</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

### Custom Width Dialog

```tsx
<Dialog>
  <DialogTrigger asChild>
    <Button>Wide Dialog</Button>
  </DialogTrigger>
  <DialogContent className="sm:max-w-[800px]">
    <DialogHeader>
      <DialogTitle>Wide dialog</DialogTitle>
    </DialogHeader>
    {/* Content */}
  </DialogContent>
</Dialog>
```

## Accessibility

The Dialog component follows WCAG 2.1 Level AA guidelines:

- ✅ **Focus Management**: Focus moves to dialog on open, returns to trigger on close
- ✅ **Keyboard Support**: Escape to close, Tab for navigation
- ✅ **Screen Reader Support**: Proper ARIA roles and labels
- ✅ **Focus Trap**: Tab navigation contained within dialog
- ✅ **Backdrop Click**: Dismisses dialog (can be disabled)
- ✅ **Close Button**: Visible and keyboard accessible

### Best Practices

1. **Provide clear title**: Use DialogTitle for all dialogs (required for accessibility)
2. **Include description**: Use DialogDescription for context
3. **Limit nesting**: Avoid opening dialogs from within dialogs
4. **Handle close**: Always provide way to close (X button, Cancel, or Escape)
5. **Keep it focused**: Dialog should have single, clear purpose

## Component Structure

The Dialog is composed of multiple sub-components:

- **Dialog**: Root component that manages state
- **DialogTrigger**: Button or element that opens the dialog
- **DialogPortal**: Renders content in a portal
- **DialogOverlay**: Semi-transparent backdrop
- **DialogContent**: Container for dialog content
- **DialogHeader**: Top section for title and description
- **DialogFooter**: Bottom section for action buttons
- **DialogTitle**: Dialog title (required for accessibility)
- **DialogDescription**: Detailed explanation
- **DialogClose**: Close button component

## Component API

<Controls />

## All Stories

<Stories />
